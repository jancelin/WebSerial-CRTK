<!doctype html>
<html lang="fr">

<head>
  <meta charset="utf-8" />
  <title>Centipede-RTK Web Serial</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" type="image/png" href="static/logo.png" />
  <link rel="stylesheet" href="static/css/styles.css">
  <link rel="stylesheet" href="static/css/index-styles.css">
</head>

<body>
  <!-- Mode Switch -->
  <div class="mode-switch-container">
    <div class="mode-switch">
      <span class="mode-label active" id="beginnerLabel">Débutant</span>
      <label class="switch">
        <input type="checkbox" id="modeToggle">
        <span class="slider"></span>
      </label>
      <span class="mode-label" id="advancedLabel">Avancé</span>
    </div>
  </div>

  <div class="main-content">
    <h1 class="brand">
      <img src="static/logo.png" alt="Logo" class="logo" />
      Centipede-RTK Web Serial
    </h1>

    <div class="main-container">
      <!-- Boutons principaux -->
      <div class="control-group">
        <div class="control-row">
          <button id="connect" class="btn btn-primary" style="flex: 1;">🔌 Connecter</button>
          <button id="disconnect" class="btn btn-primary hidden" disabled style="flex: 1;">⏏️ Déconnecter</button>
          <button id="upload" class="btn btn-success" disabled style="flex: 1;">📤 Téléverser</button>
        </div>
      </div>

      <!-- Contrôles de configuration -->
      <div class="control-group">
        <div class="control-row">
          <div style="flex: 1; height : 75px;">
            <label>Vitesse de transmission</label>
            <select id="baud">
              <option>4800</option>
              <option>9600</option>
              <option>19200</option>
              <option>28800</option>
              <option>38400</option>
              <option>57600</option>
              <option>76800</option>
              <option selected>115200</option>
              <option>230400</option>
              <option>460800</option>
              <option>576000</option>
              <option>921600</option>
            </select>
          </div>
          <div style="flex: 1; height : 75px;">
            <label>Configurations</label>
            <div class="file-group">
              <select id="configSelect">
                <option value="">— Choisir une configuration —</option>
              </select>
              <button id="refreshList" class="refresh-btn" title="Rafraîchir la liste">↻</button>
            </div>
          </div>
          <div style="flex: 0 0 auto; height : 75px;">
            <label>&nbsp;</label>
            <div class="settings-menu">
              <button class="settings-btn" id="settingsToggle" title="Paramètres avancés">⚙️</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Zone de description -->
      <div class="control-group" id="configDescriptionContainer" style="display: none;">
        <div class="config-description" id="configDescription">
          <!-- Description dynamique -->
        </div>
      </div>

      <!-- Barre de progression -->
      <div class="progress-container hidden" id="progressContainer">
        <div class="progress-header">
          <div></div>
          <button class="progress-info-btn" id="terminalToggle" title="Afficher/masquer le terminal UART">i</button>
        </div>
        <div class="progress-bar">
          <div class="progress-fill" id="progressFill" style="width: 0%"></div>
        </div>
        <div class="progress-text" id="progressText">En attente...</div>
        <div class="uart-terminal hidden" id="uartTerminal"></div>
      </div>

      <!-- Status -->
      <div id="status" class="status info">
        Prêt à se connecter
      </div>
    </div>

    <!-- Modale des paramètres -->
    <div class="settings-modal" id="settingsModal">
      <div class="settings-content">
        <div class="modal-header">
          <h2 class="modal-title">Paramètres avancés</h2>
          <button class="close-btn" id="closeModal" title="Fermer">✕</button>
        </div>

        <div class="control-group">
          <label>Fin de ligne</label>
          <select id="eol">
            <option value="\r\n" selected>CRLF</option>
            <option value="\n">LF</option>
            <option value="\r">CR</option>
          </select>
        </div>

        <div class="control-group">
          <label>Délai entre commande(s)</label>
          <input id="delay" type="number" min="0" step="0.1" value="5">
        </div>

        <div class="control-group">
          <label>Charger un fichier personnel</label>
          <input id="configFile" type="file" accept=".txt,.cfg,.conf,.ini,.log,.nmea,.csv,.*" />
        </div>

        <div class="control-group">
          <button id="save" class="btn btn-primary" style="width:100%;margin-top:8px">💾 SAVECONFIG</button>
        </div>
      </div>
    </div>
  </div>

  <footer>
    <span>© 2025 by Centipede-RTK</span>
    <a href="https://github.com/jancelin/WebSerial-CRTK" target="_blank" rel="noopener">
      <svg viewBox="0 0 16 16" aria-hidden="true" focusable="false">
        <path fill="currentColor"
          d="M8 .2a8 8 0 0 0-2.53 15.59c.4.07.55-.17.55-.38v-1.34c-2.25.49-2.72-1.08-2.72-1.08-.37-.95-.9-1.2-.9-1.2-.74-.51.06-.5.06-.5.82.06 1.25.85 1.25.85.73 1.24 1.92.88 2.39.67.07-.53.28-.88.5-1.08-1.8-.2-3.7-.9-3.7-4a3.14 3.14 0 0 1 .84-2.18 2.9 2.9 0 0 1 .08-2.15s.68-.22 2.22.83a7.6 7.6 0 0 1 4.05 0c1.54-1.05 2.22-.83 2.22-.83.45 1.08.17 1.89.09 2.09a3.13 3.13 0 0 1 .84 2.18c0 3.11-1.9 3.8-3.71 4 .29.25.54.73.54 1.48v2.2c0 .21.15.45.55.38A8 8 0 0 0 8 .2Z" />
      </svg>
      github.com/jancelin/Webserial-CRTK
    </a>
  </footer>

  <script src="static/js/script.js"></script>
  <script src="static/js/index-script.js"></script>
</body>

</html>